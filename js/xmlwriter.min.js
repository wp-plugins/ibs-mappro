
function XMLWriter(encoding,version){if(encoding)
this.encoding=encoding;if(version)
this.version=version;};(function(){function clean(node){var l=node.c.length;while(l--){if(typeof node.c[l]=='object')
clean(node.c[l]);}
node.n=node.a=node.c=null;};function format(node,indent,chr,buffer){var
xml=indent+'<'+node.n,nc=node.c.length,attr,child,i=0;for(attr in node.a)
xml+=' '+attr+'="'+node.a[attr]+'"';xml+=nc?'>':' />';buffer.push(xml);if(nc){do{child=node.c[i++];if(typeof child=='string'){if(nc==1)
return buffer.push(buffer.pop()+child+'</'+node.n+'>');else
buffer.push(indent+chr+child);}else if(typeof child=='object')
format(child,indent+chr,chr,buffer);}while(i<nc);buffer.push(indent+'</'+node.n+'>');}}
XMLWriter.prototype={encoding:'ISO-8859-1',version:'1.0',formatting:'indented',indentChar:' ',indentation:2,newLine:'\n',writeStartDocument:function(standalone){this.close();this.stack=[];this.standalone=standalone;},writeEndDocument:function(){this.active=this.root;this.stack=[];},writeDocType:function(dt){this.doctype=dt;},writeStartElement:function(name,ns){if(ns)
name=ns+':'+name;var node={n:name,a:{},c:[]};if(this.active){this.active.c.push(node);this.stack.push(this.active);}else
this.root=node;this.active=node;},writeEndElement:function(){this.active=this.stack.pop()||this.root;},writeAttributeString:function(name,value){if(this.active)
this.active.a[name]=value;},writeString:function(text){if(this.active)
this.active.c.push(text);},writeElementString:function(name,text,ns){this.writeStartElement(name,ns);this.writeString(text);this.writeEndElement();},writeCDATA:function(text){this.writeString('<![CDATA['+text+']]>');},writeComment:function(text){this.writeString('<!-- '+text+' -->');},flush:function(){if(this.stack&&this.stack[0])
this.writeEndDocument();var
chr='',indent='',num=this.indentation,formatting=this.formatting.toLowerCase()=='indented',buffer='<?xml version="'+this.version+'" encoding="'+this.encoding+'"';if(this.standalone!==undefined)
buffer+=' standalone="'+!!this.standalone+'"';buffer+=' ?>';buffer=[buffer];if(this.doctype&&this.root)
buffer.push('<!DOCTYPE '+this.root.n+' '+this.doctype+'>');if(formatting){while(num--)
chr+=this.indentChar;}
if(this.root)
format(this.root,indent,chr,buffer);return buffer.join(formatting?this.newLine:'');},close:function(){if(this.root)
clean(this.root);this.active=this.root=this.stack=null;},getDocument:window.ActiveXObject?function(){var doc=new ActiveXObject('Microsoft.XMLDOM');doc.async=false;doc.loadXML(this.flush());return doc;}:function(){return(new DOMParser()).parseFromString(this.flush(),'text/xml');}};})();