function XMLWriter(e,g){e&&(this.encoding=e);g&&(this.version=g)}
(function(){function e(a){for(var b=a.c.length;b--;)"object"==typeof a.c[b]&&e(a.c[b]);a.n=a.a=a.c=null}function g(a,b,d,c){var f=b+"<"+a.n,e=a.c.length,h,k=0;for(h in a.a)f+=" "+h+'="'+a.a[h]+'"';c.push(f+(e?">":" />"));if(e){do if(f=a.c[k++],"string"==typeof f){if(1==e)return c.push(c.pop()+f+"</"+a.n+">");c.push(b+d+f)}else"object"==typeof f&&g(f,b+d,d,c);while(k<e);c.push(b+"</"+a.n+">")}}XMLWriter.prototype={encoding:"ISO-8859-1",version:"1.0",formatting:"indented",indentChar:" ",indentation:2,
newLine:"\n",writeStartDocument:function(a){this.close();this.stack=[];this.standalone=a},writeEndDocument:function(){this.active=this.root;this.stack=[]},writeDocType:function(a){this.doctype=a},writeStartElement:function(a,b){b&&(a=b+":"+a);var d={n:a,a:{},c:[]};this.active?(this.active.c.push(d),this.stack.push(this.active)):this.root=d;this.active=d},writeEndElement:function(){this.active=this.stack.pop()||this.root},writeAttributeString:function(a,b){this.active&&(this.active.a[a]=b)},writeString:function(a){this.active&&
this.active.c.push(a)},writeElementString:function(a,b,d){this.writeStartElement(a,d);this.writeString(b);this.writeEndElement()},writeCDATA:function(a){this.writeString("<![CDATA["+a+"]]\x3e")},writeComment:function(a){this.writeString("\x3c!-- "+a+" --\x3e")},flush:function(){this.stack&&this.stack[0]&&this.writeEndDocument();var a="",b=this.indentation,d="indented"==this.formatting.toLowerCase(),c='<?xml version="'+this.version+'" encoding="'+this.encoding+'"';void 0!==this.standalone&&(c+=' standalone="'+
!!this.standalone+'"');c=[c+" ?>"];this.doctype&&this.root&&c.push("<!DOCTYPE "+this.root.n+" "+this.doctype+">");if(d)for(;b--;)a+=this.indentChar;this.root&&g(this.root,"",a,c);return c.join(d?this.newLine:"")},close:function(){this.root&&e(this.root);this.active=this.root=this.stack=null},getDocument:window.ActiveXObject?function(){var a=new ActiveXObject("Microsoft.XMLDOM");a.async=!1;a.loadXML(this.flush());return a}:function(){return(new DOMParser).parseFromString(this.flush(),"text/xml")}}})();
